<%- include('../partials/header') %>
<div class="container-fluid">
  <div class="row justify-content-center">
    <div class="col-md-9">
      <nav aria-label="breadcrumb" class="mt-3">
        <ol class="breadcrumb">
          <li class="breadcrumb-item"><a href="#">Home</a></li>
          <li class="breadcrumb-item">
            <a href="/admins/management/admin">Admin</a>
          </li>
          <li class="breadcrumb-item">
            <a href="/admins/management/config">Config</a>
          </li>
          <li class="breadcrumb-item">
            <a href="/admins/management/profile">Profile</a>
          </li>
        </ol>
      </nav>
      <% if (opt === 'admin') { %>
        <form action="/admins/check_attend" method="POST">
          <table class="table table-striped">
            <thead>
              <tr>
                <th scope="col">Email</th>
                <th scope="col">Name</th>
                <th scope="col">Title</th>
                <th scope="col">Attend</th>
              </tr>
            </thead>
            <tbody>
              <% users.forEach(user => { %>
              <tr>
                <th scope="row"><%= user.email %></th>
                <td><%= user.name %></td>
                <td><%= user.title %></td>
                <td><input value="<%= user.event_id %> <%= user.email %>" type="checkbox" name="attend" <%= +user.attend === 1 ? "checked" : "" %>></td>
              </tr>
              <% }); %>
            </tbody>
          </table>
          <tfoot>
            <button type="submit" class="btn btn-outline-success float-right"><i class="fa fa-floppy-o" aria-hidden="true"></i> SAVE</button>
          </tfoot>
        </form>
      <% } else if (opt === 'config') { %>
      <form action="/admins/config" method="POST">
        <div class="form-group">
          <label>Home's content</label>
          <input
            type="text"
            class="form-control"
            aria-describedby="emailHelp"
            name="home"
            value="<%= home %>"
          />
        </div>
        <div class="form-group">
          <label>Thank you's content</label>
          <input
            type="text"
            class="form-control"
            aria-describedby="emailHelp"
            name="thanks"
            value="<%= thanks %>"
          />
        </div>
        <button type="submit" class="btn btn-primary">Submit</button>
      </form>
      <% } else if (opt === 'profile') {%>
        <div class="card">
          <div class="card-header">
            <ul
              class="nav nav-tabs card-header-tabs"
              id="bologna-list"
              role="tablist"
            >
              <li class="nav-item">
                <a
                  class="nav-link active"
                  href="#profile"
                  role="tab"
                  aria-controls="profile"
                  aria-selected="true"
                  >Profile</a
                >
              </li>
              <li class="nav-item">
                <a
                  class="nav-link"
                  href="#avatar"
                  role="tab"
                  aria-controls="avatar"
                  aria-selected="false"
                  >Avatar</a
                >
              </li>
              <li class="nav-item">
                <a
                  class="nav-link"
                  href="#password"
                  role="tab"
                  aria-controls="password"
                  aria-selected="false"
                  >Password</a
                >
              </li>
            </ul>
          </div>
  
          <div class="card-body">
            <div class="tab-content mt-3">
              <div class="tab-pane active" id="profile" role="tabpanel">
                <div class="row">
                  <div class="col-md-12">
                    <form action="/admins/profile_update" method="POST">
                      <div class="form-group row">
                        <label
                          for="email"
                          class="col-4 col-form-label font-weight-bold"
                          >Email</label
                        >
                        <div class="col-8">
                          <input
                            name="email"
                            class="form-control here"
                            type="text"
                            value="<%= email %>"
                            readonly
                          />
                        </div>
                      </div>
                      <div class="form-group row">
                        <label
                          for="name"
                          class="col-4 col-form-label font-weight-bold"
                          >Name</label
                        >
                        <div class="col-8">
                          <input
                            id="name"
                            name="name"
                            class="form-control here"
                            type="text"
                            value="<%= name %> "
                          />
                        </div>
                      </div>
                      <div class="form-group row">
                        <label
                          for="phone"
                          class="col-4 col-form-label font-weight-bold"
                          >Phone</label
                        >
                        <div class="col-8">
                          <input
                            id="phone"
                            name="phone"
                            class="form-control here"
                            type="text"
                            value="<%= phone %> "
                          />
                        </div>
                      </div>
                      <button
                        type="submit"
                        class="btn btn-outline-success float-right"
                      >
                        <i class="fa fa-floppy-o" aria-hidden="true"></i> SAVE
                      </button>
                    </form>
                  </div>
                </div>
              </div>

              <div
                class="tab-pane"
                id="avatar"
                role="tabpanel"
                aria-labelledby="avatar-tab"
              >
                <div class="row">
                  <div class="col-md-12">
                    <form
                      action="/admins/avatar_update"
                      method="POST"
                      enctype="multipart/form-data"
                    >
                      <div class="row justify-content-center mb-5">
                        <div class="col-sm-3">
                          <div class="text-center">
                            <img
                              src="<%= avatar %> "
                              class="avatar img-circle img-thumbnail"
                              alt="avatar"
                            />
                            <input
                              type="file"
                              class="text-center center-block file-upload"
                              name="avatar"
                            />
                          </div>
                        </div>
                      </div>
                      <button
                        type="submit"
                        class="btn btn-outline-success float-right"
                      >
                        <i class="fa fa-floppy-o" aria-hidden="true"></i> SAVE
                      </button>
                    </form>
                  </div>
                </div>
              </div>
  
              
  
              <div
                class="tab-pane"
                id="password"
                role="tabpanel"
                aria-labelledby="password-tab"
              >
                <div class="row">
                  <div class="col-md-12">
                    <% if (typeof error !== "undefined") { %>
                    <div class="alert alert-danger" role="alert">
                      <%= error %>
                    </div>
                    <% } %>
                    <form action="/admins/password_update" method="POST">
                      <div class="form-group row">
                        <label class="col-4 col-form-label font-weight-bold"
                          >Current password</label
                        >
                        <div class="col-8">
                          <input
                            class="form-control here"
                            type="password"
                            name="currentpassword"
                          />
                        </div>
                      </div>
                      <div class="form-group row">
                        <label class="col-4 col-form-label font-weight-bold"
                          >New password</label
                        >
                        <div class="col-8">
                          <input
                            name="newpassword"
                            class="form-control here"
                            type="password"
                          />
                        </div>
                      </div>
                      <div class="form-group row">
                        <label class="col-4 col-form-label font-weight-bold"
                          >Retype new password</label
                        >
                        <div class="col-8">
                          <input
                            name="retypenewpassword"
                            class="form-control here"
                            type="password"
                          />
                        </div>
                      </div>
                      <button
                        type="submit"
                        class="btn btn-outline-success float-right"
                      >
                        <i class="fa fa-floppy-o" aria-hidden="true"></i> SAVE
                      </button>
                    </form>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      <% } %>
    </div>
  </div>
</div>
<%- include('../partials/footer') %>

<script type="text/javascript">
  $(document).ready(function () {
    var readURL = function (input) {
      if (input.files && input.files[0]) {
        var reader = new FileReader();

        reader.onload = function (e) {
          $(".avatar").attr("src", e.target.result);
        };

        reader.readAsDataURL(input.files[0]);
      }
    };

    $(".file-upload").on("change", function () {
      readURL(this);
    });
  });

  $('#bologna-list a').on('click', function (e) {
    e.preventDefault()
  $(this).tab('show');
});
</script>
